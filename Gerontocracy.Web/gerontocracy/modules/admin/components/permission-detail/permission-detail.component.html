<div class="geronto-loading-shade" *ngIf="isLoading">
  <mat-spinner></mat-spinner>
</div>

<div class="geronto-nav-container">
  <app-nav-top-bar (close)="close.emit($event)" [title]="data.userName" (sizeChanged)="toggleSize($event)"></app-nav-top-bar>

  <mat-accordion>
    <mat-expansion-panel>
      <mat-expansion-panel-header>
        <mat-panel-title>
          Allgemeine Daten
        </mat-panel-title>
      </mat-expansion-panel-header>
      <table>
        <tr>
          <td>Registriert seit</td>
          <td>{{data.registerDate}}</td>
        </tr>
        <tr>
          <td>Vorfälle eingereicht</td>
          <td>{{data.vorfallCount}}</td>
        </tr>
        <tr>
          <td>Email bestätigt</td>
          <td>{{data.emailConfirmed ? "Ja": "Nein"}}</td>
        </tr>
        <tr *ngIf="data.lockoutEnd">
          <td>Gesperrt bis:</td>
          <td>{{data.lockoutEnd | date: 'dd.MM.yyyy hh:mm:ss'}}</td>
        </tr>
      </table>
    </mat-expansion-panel>
    <mat-expansion-panel>
      <mat-expansion-panel-header>
        <mat-panel-title>
          Berechtigungen
        </mat-panel-title>
        <mat-panel-description>
          {{rolesAggregated()}}
        </mat-panel-description>
      </mat-expansion-panel-header>
      <mat-selection-list>
        Zugewiesene Rollen
        <mat-list-option *ngFor="let role of adminService.roles" color="accent" (click)="toggleRole(role.id)"
          [selected]="roleToSelected(role.id)">
          {{role.name}}
        </mat-list-option>
        <button mat-stroked-button color="accent" (click)="saveRoles($event)">
          <mat-icon>save</mat-icon> Speichern
        </button>
      </mat-selection-list>
    </mat-expansion-panel>
  </mat-accordion>
</div>